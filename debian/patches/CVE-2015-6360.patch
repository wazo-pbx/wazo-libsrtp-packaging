From: Markus Koschany <apo@debian.org>
Date: Thu, 31 Mar 2016 21:09:43 +0200
Subject: CVE-2015-6360

Prevent potential DoS attack due to lack of bounds checking on RTP header
CSRC count and extension header length. Only the srtp_unprotect function is
affected. AEAD mode does not exist.

Debian-Bug: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=807698
Origin: https://github.com/cisco/libsrtp/commit/704a31774db0dd941094fd2b47c21638b8dc3de2
---
 srtp/srtp.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/srtp/srtp.c b/srtp/srtp.c
index 7fd19e6..ef7ac62 100644
--- a/srtp/srtp.c
+++ b/srtp/srtp.c
@@ -1084,6 +1084,8 @@ srtp_unprotect(srtp_ctx_t *ctx, void *srtp_hdr, int *pkt_octet_len) {
       srtp_hdr_xtnd_t *xtn_hdr = (srtp_hdr_xtnd_t *)enc_start;
       enc_start += (ntohs(xtn_hdr->length) + 1);
     }  
+    if (!((uint8_t*)enc_start < (uint8_t*)hdr + (*pkt_octet_len - tag_len)))
+        return err_status_parse_err;
     enc_octet_len = (uint32_t)(*pkt_octet_len - tag_len 
 			       - ((enc_start - (uint32_t *)hdr) << 2));
   } else {
